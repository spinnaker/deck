query fetchApplication($appName: String!) {
  application(appName: $appName) {
    id
    name
    account
    environments {
      id
      name
      state {
        id
        artifacts {
          id
          name
          environment
          type
          reference
          versions(statuses: [PENDING, APPROVED, DEPLOYING, CURRENT]) {
            id
            buildNumber
            version
            createdAt
            status
            gitMetadata {
              commit
              author
              branch
              commitInfo {
                sha
                link
                message
              }
              pullRequest {
                number
                link
              }
            }
            deployedAt
            lifecycleSteps {
              startedAt
              completedAt
              type
              status
            }
            constraints {
              type
              status
              attributes
            }
          }
          pinnedVersion {
            id
            version
            buildNumber
            pinnedAt
            pinnedBy
            comment
            gitMetadata {
              commitInfo {
                message
              }
            }
          }
        }
        resources {
          id
          kind
          displayName
          moniker {
            app
            stack
            detail
          }
          location {
            regions
          }
        }
      }
    }
  }
}

query fetchResourceStatus($appName: String!) {
  application(appName: $appName) {
    id
    name
    environments {
      id
      name
      state {
        id
        resources {
          id
          kind
          status
        }
      }
    }
  }
}

mutation UpdateConstraint($application: String, $environment: String, $status: DgsConstraintStatusUpdate) {
  updateConstraintStatus(application: $application, environment: $environment, status: $status)
}
