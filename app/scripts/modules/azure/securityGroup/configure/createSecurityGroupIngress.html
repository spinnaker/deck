<div class="modal-body">
  <div class="row"></div>
  <div class="form-group">
    <div class="form-group">
      <div class="col-md-12">
        <table class="table table-condensed packed">
          <thead>
            <tr>
              <th style="width: 21%">Protocol</th>
              <th style="width: 32%">
                Source IP/CIDR ranges<help-field key="azure.securityGroup.ingress.sourceIPCIDRRanges"></help-field>
              </th>
              <th style="width: 32%">
                Destination port ranges<help-field key="azure.securityGroup.ingress.destPortRanges"></help-field>
              </th>
              <th style width="15%">Actions<help-field key="azure.securityGroup.ingress.actions"></help-field></th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="rule in securityGroup.securityRules">
              <td>
                <select class="form-control input-sm" ng-model="rule.protocolUI">
                  <option value="tcp">TCP</option>
                  <option value="udp">UDP</option>
                  <option value="*">ANY</option>
                </select>
              </td>
              <td>
                <input
                  class="form-control input-sm"
                  type="text"
                  value="*"
                  pattern="^\*$|^((25[0-5]|2[0-4]\d|[01]?\d\d?)[.]){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)(\/([1-9]|[1-2]\d|3[0-2]))?(,((25[0-5]|2[0-4]\d|[01]?\d\d?)[.]){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)(\/([1-9]|[1-2]\d|3[0-2]))?)*$"
                  ng-model="rule.sourceIPCIDRRanges"
                  ng-change="ctrl.sourceIPCIDRUpdated(securityGroup.securityRules, $index)"
                  required
                />
              </td>
              <td>
                <input
                  class="form-control input-sm"
                  type="text"
                  value="80"
                  pattern="^\*$|^((\d|[1-9]\d{1,3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])|(\d|[1-9]\d{1,3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])-(\d|[1-9]\d{1,3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5]))(,((\d|[1-9]\d{1,3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])|(\d|[1-9]\d{1,3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])-(\d|[1-9]\d{1,3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])))*$"
                  ng-model="rule.destPortRanges"
                  ng-change="ctrl.portUpdated(securityGroup.securityRules, $index)"
                  required
                />
              </td>
              <td>
                <a class="btn-link sm-label" ng-click="ctrl.moveUp(securityGroup.securityRules, $index)"
                  ><span class="glyphicon glyphicon-arrow-up"></span>
                </a>
                <a class="btn-link sm-label" ng-click="ctrl.moveDown(securityGroup.securityRules, $index)"
                  ><span class="glyphicon glyphicon-arrow-down"></span>
                </a>
                <a class="btn-link sm-label" ng-click="ctrl.removeRule(securityGroup.securityRules, $index)"
                  ><span class="glyphicon glyphicon-trash"></span>
                </a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="form-group small" style="margin-top: 20px">
      <div class="col-md-12">
        <button class="add-new col-md-12" ng-click="ctrl.addRule(securityGroup.securityRules)">
          <span class="glyphicon glyphicon-plus-sign"></span> Add new
          <firewall-label label="Firewall"></firewall-label> Rule
        </button>
      </div>
    </div>
  </div>
</div>
