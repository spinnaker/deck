<div modal-page class="scaling-policy-modal form-inline">
  <task-monitor monitor="ctrl.taskMonitor"></task-monitor>
  <modal-close dismiss="$dismiss()"></modal-close>
  <div class="modal-header">
    <h4 class="modal-title">{{ctrl.action}} scaling policy</h4>
  </div>
  <div class="modal-body">
    <form name="form" novalidate>
      <h4 class="section-heading">Conditions</h4>
      <div class="section-body">
        <alarm-configurer
          alarm="ctrl.command.alarm"
          multiple-alarms="ctrl.viewState.multipleAlarms"
          server-group="ctrl.serverGroup"
          step-adjustments="ctrl.command.step.stepAdjustments"
          steps-changed="ctrl.stepsChanged"
          update-alarm="ctrl.alarmChanged"
        ></alarm-configurer>
      </div>
      <h4 class="section-heading">Actions</h4>
      <div class="section-body" ng-if="!ctrl.command.alarm.metricName">
        <h4 class="text-center">Select a metric</h4>
      </div>
      <div class="section-body" ng-if="ctrl.command.alarm.metricName">
        <div ng-if="ctrl.command.simple">
          <div class="row">
            <div class="col-md-10 col-md-offset-1">
              <p>
                This is a simple scaling policy. To declare different actions based on the magnitude of the alarm,
                <strong>switch to a <a href ng-click="ctrl.switchMode()">step policy</a>.</strong>
              </p>
            </div>
          </div>
          <aws-simple-policy-action
            adjustment-type="ctrl.viewState.adjustmentType"
            adjustment-type-changed="ctrl.adjustmentTypeChanged"
            operator="ctrl.viewState.operator"
            scaling-adjustment="ctrl.command.simple.scalingAdjustment"
            update-scaling-adjustment="ctrl.scalingAdjustmentChanged"
          ></aws-simple-policy-action>
        </div>
        <div ng-if="ctrl.command.step">
          <step-policy-action
            adjustment-type="ctrl.viewState.adjustmentType"
            adjustment-type-changed="ctrl.adjustmentTypeChanged"
            alarm="ctrl.command.alarm"
            is-min="ctrl.viewState.comparatorBound === 'min'"
            operator="ctrl.viewState.operator"
            step="ctrl.command.step"
            steps-changed="ctrl.stepsChanged"
          >
          </step-policy-action>
        </div>
      </div>
      <scaling-policy-additional-settings
        command="ctrl.command"
        is-instance-type="ctrl.viewState.adjustmentType === 'instances'"
        is-new="ctrl.viewState.isNew"
        operator="ctrl.viewState.operator"
        update-command="ctrl.commandChanged"
      ></scaling-policy-additional-settings>
    </form>
  </div>

  <div class="modal-footer">
    <button class="btn btn-default" ng-click="ctrl.cancel()">Cancel</button>
    <submit-button
      is-disabled="!form.$valid"
      submitting="taskMonitor.submitting"
      on-click="ctrl.save()"
      is-new="ctrl.viewState.isNew"
    ></submit-button>
  </div>
</div>
